!function(e){"use strict";function t(e,t,n){"addEventListener"in window?e.addEventListener(t,n,!1):"attachEvent"in window&&e.attachEvent("on"+t,n)}function n(e,t,n){"removeEventListener"in window?e.removeEventListener(t,n,!1):"detachEvent"in window&&e.detachEvent("on"+t,n)}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function i(e){return se+"["+fe+"] "+e}function r(e){le&&"object"==typeof window.console&&console.log(i(e))}function a(e){"object"==typeof window.console&&console.warn(i(e))}function u(){c(),r("Initialising iFrame ("+location.href+")"),l(),f(),d("background",K),d("padding",G),M(),v(),y(),m(),N(),b(),ae=I(),q("init","Init message from host page"),Ne()}function c(){function t(e){return"true"===e}var n=re.substr(de).split(":");fe=n[0],X=e!==n[1]?Number(n[1]):X,Q=e!==n[2]?t(n[2]):Q,le=e!==n[3]?t(n[3]):le,ue=e!==n[4]?Number(n[4]):ue,j=e!==n[6]?t(n[6]):j,Y=n[7],oe=e!==n[8]?n[8]:oe,K=n[9],G=n[10],ye=e!==n[11]?Number(n[11]):ye,ae.enable=e!==n[12]&&t(n[12]),ge=e!==n[13]?n[13]:ge,Oe=e!==n[14]?n[14]:Oe}function l(){function e(e,t){return"function"==typeof e&&(r("Setup custom "+t+"CalcMethod"),ke[t]=e,e="custom"),e}"iFrameResizer"in window&&Object===window.iFrameResizer.constructor&&(!function(){var e=window.iFrameResizer;r("Reading data from page: "+JSON.stringify(e)),Ie="messageCallback"in e?e.messageCallback:Ie,Ne="readyCallback"in e?e.readyCallback:Ne,ve="targetOrigin"in e?e.targetOrigin:ve,oe="heightCalculationMethod"in e?e.heightCalculationMethod:oe,Oe="widthCalculationMethod"in e?e.widthCalculationMethod:Oe}(),oe=e(oe,"height"),Oe=e(Oe,"width")),r("TargetOrigin for parent set to: "+ve)}function s(e,t){return-1!==t.indexOf("-")&&(a("Negative CSS value ignored for "+e),t=""),t}function d(t,n){e!==n&&""!==n&&"null"!==n&&(document.body.style[t]=n,r("Body "+t+' set to "'+n+'"'))}function f(){e===Y&&(Y=X+"px"),d("margin",s("margin",Y))}function m(){document.documentElement.style.height="",document.body.style.height="",r('HTML & body height set to "auto"')}function g(e){var i={add:function(n){function o(){q(e.eventName,e.eventType)}Ae[n]=o,t(window,n,o)},remove:function(e){var t=Ae[e];delete Ae[e],n(window,e,t)}};e.eventNames&&Array.prototype.map?(e.eventName=e.eventNames[0],e.eventNames.map(i[e.method])):i[e.method](e.eventName),r(o(e.method)+" event listener: "+e.eventType)}function h(e){g({method:e,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),g({method:e,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),g({method:e,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),g({method:e,eventType:"Input",eventName:"input"}),g({method:e,eventType:"Mouse Click",eventName:"click"}),g({method:e,eventType:"Orientation Change",eventName:"orientationchange"}),g({method:e,eventType:"Print",eventName:["afterprint","beforeprint"]}),g({method:e,eventType:"Ready State Change",eventName:"readystatechange"}),g({method:e,eventType:"Touch Start",eventName:"touchstart"}),g({method:e,eventType:"Touch End",eventName:"touchend"}),g({method:e,eventType:"Touch Cancel",eventName:"touchcancel"}),g({method:e,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),g({method:e,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),g({method:e,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===ge&&g({method:e,eventType:"IFrame Resized",eventName:"resize"})}function p(e,t,n,o){return t!==e&&(e in n||(a(e+" is not a valid option for "+o+"CalculationMethod."),e=t),r(o+' calculation method set to "'+e+'"')),e}function v(){oe=p(oe,ne,ze,"height")}function y(){Oe=p(Oe,Se,Re,"width")}function b(){!0===j?(h("add"),A()):r("Auto Resize disabled")}function w(){r("Disable outgoing messages"),he=!1}function T(){r("Remove event listener: Message"),n(window,"message",J)}function E(){null!==$&&$.disconnect()}function S(){h("remove"),E(),clearInterval(ce)}function O(){w(),T(),!0===j&&S()}function M(){var e=document.createElement("div");e.style.clear="both",e.style.display="block",document.body.appendChild(e)}function I(){function n(){return{x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop}}function o(e){var t=e.getBoundingClientRect(),o=n();return{x:parseInt(t.left,10)+parseInt(o.x,10),y:parseInt(t.top,10)+parseInt(o.y,10)}}function i(t){var n=t.split("#")[1]||t,i=decodeURIComponent(n),a=document.getElementById(i)||document.getElementsByName(i)[0];e!==a?function(e){var t=o(e);r("Moving to in page link (#"+n+") at x: "+t.x+" y: "+t.y),V(t.y,t.x,"scrollToOffset")}(a):(r("In page link (#"+n+") not found in iFrame, so sending to parent"),V(0,0,"inPageLink","#"+n))}function u(){""!==location.hash&&"#"!==location.hash&&i(location.href)}function c(){Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),function(e){"#"!==e.getAttribute("href")&&t(e,"click",function(e){e.preventDefault(),i(this.getAttribute("href"))})})}function l(){t(window,"hashchange",u)}function s(){setTimeout(u,_)}return ae.enable?Array.prototype.forEach&&document.querySelectorAll?(r("Setting up location.hash handlers"),c(),l(),s()):a("In page linking not fully supported in this browser! (See README.md for IE8 workaround)"):r("In page linking not enabled"),{findTarget:i}}function N(){r("Enable public methods"),Me.parentIFrame={autoResize:function(e){return!0===e&&!1===j?(j=!0,b()):!1===e&&!0===j&&(j=!1,S()),j},close:function(){V(0,0,"close"),O()},getId:function(){return fe},getPageInfo:function(e){"function"==typeof e?(Ce=e,V(0,0,"pageInfo")):(Ce=function(){},V(0,0,"pageInfoStop"))},moveToAnchor:function(e){ae.findTarget(e)},reset:function(){B("parentIFrame.reset")},scrollTo:function(e,t){V(t,e,"scrollTo")},scrollToOffset:function(e,t){V(t,e,"scrollToOffset")},sendMessage:function(e,t){V(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){oe=e,v()},setWidthCalculationMethod:function(e){Oe=e,y()},setTargetOrigin:function(e){r("Set targetOrigin: "+e),ve=e},size:function(e,t){q("size","parentIFrame.size("+((e||"")+(t?","+t:""))+")",e,t)}}}function C(){0!==ue&&(r("setInterval: "+ue+"ms"),ce=setInterval(function(){q("interval","setInterval: "+ue)},Math.abs(ue)))}function k(){function t(e){function t(e){!1===e.complete&&(r("Attach listeners to "+e.src),e.addEventListener("load",a,!1),e.addEventListener("error",u,!1),l.push(e))}"attributes"===e.type&&"src"===e.attributeName?t(e.target):"childList"===e.type&&Array.prototype.forEach.call(e.target.querySelectorAll("img"),t)}function n(e){l.splice(l.indexOf(e),1)}function o(e){r("Remove listeners from "+e.src),e.removeEventListener("load",a,!1),e.removeEventListener("error",u,!1),n(e)}function i(t,n,i){o(t.target),q(n,i+": "+t.target.src,e,e)}function a(e){i(e,"imageLoad","Image loaded")}function u(e){i(e,"imageLoadFailed","Image load failed")}function c(e){q("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type),V(0,0,triggerEvent,e),e.forEach(t)}var l=[],s=window.MutationObserver||window.WebKitMutationObserver,d=function(){var e=document.querySelector("body"),t={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return d=new s(c),r("Create body MutationObserver"),d.observe(e,t),d}();return{disconnect:function(){"disconnect"in d&&(r("Disconnect body MutationObserver"),d.disconnect(),l.forEach(o))}}}function A(){var e=0>ue;window.MutationObserver||window.WebKitMutationObserver?e?C():$=k():(r("MutationObserver not supported in this browser!"),C())}function x(e,t){var n=0;return t=t||document.body,n="defaultView"in document&&"getComputedStyle"in document.defaultView?null!==(n=document.defaultView.getComputedStyle(t,null))?n[e]:0:function(e){if(/^\d+(px)?$/i.test(e))return parseInt(e,U);var n=t.style.left,o=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft,t.style.left=n,t.runtimeStyle.left=o,e}(t.currentStyle[e]),parseInt(n,U)}function z(e){e>Te/2&&r("Event throttle increased to "+(Te=2*e)+"ms")}function R(e,t){for(var n=t.length,i=0,a=0,u=o(e),c=xe(),l=0;l<n;l++)(i=t[l].getBoundingClientRect()[e]+x("margin"+u,t[l]))>a&&(a=i);return c=xe()-c,r("Parsed "+n+" HTML elements"),r("Element position calculated in "+c+"ms"),z(c),a}function L(e){return[e.bodyOffset(),e.bodyScroll(),e.documentElementOffset(),e.documentElementScroll()]}function F(e,t){var n=document.querySelectorAll("["+t+"]");return 0===n.length&&(a("No tagged elements ("+t+") found on page"),document.querySelectorAll("body *")),R(e,n)}function P(){return document.querySelectorAll("body *")}function W(t,n,o,i){function a(){return!(t in{init:1,interval:1,size:1})}function u(){return oe in me||Q&&Oe in me}function c(){r("No change in size detected")}var l,s;!function(){function t(e,t){return!(Math.abs(e-t)<=ye)}return l=e!==o?o:ze[oe](),s=e!==i?i:Re[Oe](),t(te,l)||Q&&t(Ee,s)}()&&"init"!==t?a()&&u()?B(n):t in{interval:1}||c():(D(),V(te=l,Ee=s,t))}function q(e,t,n,o){be&&e in Z?r("Trigger event cancelled: "+e):(e in{reset:1,resetPage:1,init:1}||(r("Trigger event: "+t),window.parentIFrame.sendMessage("Event caused: "+e),V(0,0,e,"event caused")),"init"===e?W(e,t,n,o):Le(e,t,n,o))}function D(){be||(be=!0,r("Trigger event lock on")),clearTimeout(we),we=setTimeout(function(){be=!1,r("Trigger event lock off"),r("--")},_)}function H(e){te=ze[oe](),Ee=Re[Oe](),V(te,Ee,e)}function B(e){var t=oe;oe=ne,r("Reset trigger event: "+e),D(),H("reset"),oe=t}function V(t,n,o,i,a){!0===he&&(e===a?a=ve:r("Message targetOrigin: "+a),function(){var u=fe+":"+t+":"+n+":"+o+(e!==i?":"+i:"");r("Sending message to host page ("+u+")"),pe.postMessage(se+u,a)}())}function J(e){function n(){return e.data.split("]")[1].split(":")[0]}function o(){return e.data.substr(e.data.indexOf(":")+1)}function i(){return!("undefined"!=typeof module&&module.exports)&&"iFrameResize"in window}function c(){return e.data.split(":")[2]in{true:1,false:1}}function l(){var t=n();t in s?s[t]():i()||c()||a("Unexpected message ("+e.data+")")}var s={init:function(){"interactive"===document.readyState||"complete"===document.readyState?(re=e.data,pe=e.source,u(),ee=!1,setTimeout(function(){ie=!1},_)):(r("Waiting for page ready"),t(window,"readystatechange",s.initFromParent))},reset:function(){ie?r("Page reset ignored by init"):(r("Page size reset by host page"),H("resetPage"))},resize:function(){q("resizeParent","Parent window requested size check")},moveToAnchor:function(){ae.findTarget(o())},inPageLink:function(){this.moveToAnchor()},pageInfo:function(){var e=o();r("PageInfoFromParent called from parent: "+e),Ce(JSON.parse(e)),r(" --")},message:function(){var e=o();r("MessageCallback called from parent: "+e),Ie(JSON.parse(e)),r(" --")}};se===(""+e.data).substr(0,de)&&(!1===ee?l():c()?s.init():r('Ignored message of type "'+n()+'". Received before initialization.'))}if("undefined"!=typeof window){var j=!0,U=10,K="",X=0,Y="",$=null,G="",Q=!1,Z={resize:1,click:1},_=128,ee=!0,te=1,ne="bodyOffset",oe=ne,ie=!0,re="",ae={},ue=32,ce=null,le=!1,se="[iFrameSizer]",de=se.length,fe="",me={max:1,min:1,bodyScroll:1,documentElementScroll:1},ge="child",he=!0,pe=window.parent,ve="*",ye=0,be=!1,we=null,Te=16,Ee=1,Se="scroll",Oe=Se,Me=window,Ie=function(){a("MessageCallback function not defined")},Ne=function(){},Ce=function(){},ke={height:function(){return a("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return a("Custom width calculation function not defined"),document.body.scrollWidth}},Ae={},xe=Date.now||function(){return(new Date).getTime()},ze={bodyOffset:function(){return document.body.offsetHeight+x("marginTop")+x("marginBottom")},offset:function(){return ze.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return ke.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,L(ze))},min:function(){return Math.min.apply(null,L(ze))},grow:function(){return ze.max()},lowestElement:function(){return Math.max(ze.bodyOffset(),R("bottom",P()))},taggedElement:function(){return F("bottom","data-iframe-height")}},Re={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return ke.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(Re.bodyScroll(),Re.documentElementScroll())},max:function(){return Math.max.apply(null,L(Re))},min:function(){return Math.min.apply(null,L(Re))},rightMostElement:function(){return R("right",P())},taggedElement:function(){return F("right","data-iframe-width")}},Le=function(e){var t,n,o,i=null,r=0,a=function(){r=xe(),i=null,o=e.apply(t,n),i||(t=n=null)};return function(){var u=xe();r||(r=u);var c=Te-(u-r);return t=this,n=arguments,c<=0||c>Te?(i&&(clearTimeout(i),i=null),r=u,o=e.apply(t,n),i||(t=n=null)):i||(i=setTimeout(a,c)),o}}(W);t(window,"message",J),"loading"!==document.readyState&&window.parent.postMessage("[iFrameResizerChild]Ready","*")}}();
